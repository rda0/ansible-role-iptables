##### iptables rules configuration file #####


## General options

# Debugging (verbosity: 0=off, 1=debug, 2=debugrules)
DEBUG=2

# Script options
PATH=/sbin:/usr/sbin:/bin:/usr/bin

# Logging options (`--log-prefix` always required as last option)
LOG_OPTS="--log-level 7 --log-ip-options --log-uid --log-prefix"

# Interfaces
IF_EXT="{{ iptables_if_ext | default(ansible_default_ipv4.interface) }}"
IF_INT=""

# Allow ICMP echo-request from anywhere (true|false)
ALLOW_PING_INET="true"


### IP addresses (single IP addresses)

## IP addresses with administrative access
NET4_ADM_1="192.33.99.222"   # tipitina.ethz.ch   (daduke)
NET4_ADM_2="192.33.99.55"    # kedavra.ethz.ch    (sasquatch)
NET4_ADM_3="192.33.96.71"    # dumbledore.ethz.ch (chris-tux)
NET4_ADM_4="192.33.99.99"    # snidget.ethz.ch    (rda)
NET4_ADM_5="192.33.96.100"   # inferius.ethz.ch   (ataraxia)
NET4_ADM_6="192.33.98.60"    # reparo.ethz.ch     (shamu)
NET4_ADM_7="192.33.97.122"   # portus.ethz.ch     (globi)
NET4_ADM_8="192.33.96.147"   # methyer.ethz.ch    (tarzeau)
NET4_ADM_9="192.33.98.148"   # ash.ethz.ch        (amartako)
NET4_ADM_10="129.132.89.142" # griphook.ethz.ch   (jumphost)
NET4_ADM_11="129.132.89.144" # hirzli.ethz.ch     (jumphost)
NET4_ADM_12="" #"129.132.86.215" # phd-webxen.ethz.ch
NET4_ADM_13="" #"129.132.86.214" # phd-systemxen.ethz.ch
NET4_ADM_14="" #"129.132.53.172" # silberspitz.ethz.ch
NET4_ADM_15="" #"129.132.80.42"  # silberspitz-hpx137.ethz.ch
# Script variables
NET4_ADMIN="${NET4_ADM_1} ${NET4_ADM_2} ${NET4_ADM_3} ${NET4_ADM_4} ${NET4_ADM_5} ${NET4_ADM_6} ${NET4_ADM_7} ${NET4_ADM_8} ${NET4_ADM_9} ${NET4_ADM_10} ${NET4_ADM_11} ${NET4_ADM_12} ${NET4_ADM_13} ${NET4_ADM_14} ${NET4_ADM_15}"
NET6_ADMIN=""

## Update servers
NET4_UPD_PHD="129.132.53.171 129.132.86.210"
NET4_UPD_DEBIAN="212.211.132.32 195.20.242.89 217.196.149.233 212.211.132.250"
NET4_UPD_UBUNTU="91.189.88.152 91.189.88.162 91.189.88.149 91.189.91.26 91.189.88.161 91.189.91.23"
# Script variables
NET4_UPDATE="${NET4_UPD_PHD} ${NET4_UPD_DEBIAN} ${NET4_UPD_UBUNTU}"
NET6_UPDATE=""


### Networks (in CIDR notation)

## Local server networks
NET4_SRV_PHYS_DC_DOCK_1="129.132.89.128/25"
NET4_SRV_PHYS_SERVER="129.132.86.192/27"
NET4_SRV_PHYS_DC_SERVER_1="129.132.80.0/26"
NET4_SRV_LAB="192.33.97.20/32 192.33.97.21/32 192.33.97.22/32 192.33.97.23/32"
# Script variables
NET4_SERVER="${NET4_SRV_PHYS_DC_DOCK_1} ${NET4_SRV_PHYS_SERVER} ${NET4_SRV_PHYS_DC_SERVER_1} ${NET4_SRV_LAB}"
NET6_SERVER=""

## Custom networks (for host specific rules)
# Script variables
NET4_CUSTOM="{{ iptables_net4_custom | default() }}"
NET6_CUSTOM="{{ iptables_net6_custom | default() }}"

## Local trusted networks (allowed: icmp, policy: REJECT)
NET4_TRU_ETH="82.130.64.0/18 129.132.0.0/16 195.176.96.0/19 148.187.192.0/19 192.33.87.0/24 192.33.88.0/23 192.33.91.0/24 192.33.92.0/24 192.33.93.0/24 192.33.94.0/23 192.33.96.0/21 192.33.104.0/22 192.33.108.0/23 192.33.110.0/24"
NET6_TRU_ETH="2001:67c:10ec::/48"
# Script variables
NET4_TRUSTED="${NET4_TRU_ETH}"
NET6_TRUSTED="${NET6_TRU_ETH}"

## Private networks
# Private IPv4 address spaces (RFC 1918)
NET4_PRIVATE="10.0.0.0/8 172.16.0.0/12 192.168.0.0/16"
NET4_PRIVATE_EXCEPT="172.31.88.0/24 172.31.7.0/25 172.31.42.96/27 172.31.12.0/24 172.31.108.0/24 172.31.34.32/27 172.31.51.224/27 172.31.6.192/27 172.31.44.128/26 172.31.23.64/26 172.31.13.0/24 172.31.90.0/24 172.31.92.0/24 172.31.6.224/27"
# Unique local IPv6 address spaces (RFC 4193)
NET6_PRIVATE="fc00::/7"
NET6_PRIVATE_EXCEPT=""

#### Open Ports

### Admin
## Inbound
# ssh
I_TCP_ADM="{{ iptables_i_tcp_adm | default('22') }}"
# 
I_UDP_ADM="{{ iptables_i_udp_adm | default() }}"
## Outbound
# ssh
O_TCP_ADM="{{ iptables_o_tcp_adm | default('22') }}"
# 
O_UDP_ADM="{{ iptables_o_udp_adm | default() }}"

### Update
## Inbound
# 
I_TCP_UPD="{{ iptables_i_tcp_upd | default() }}"
# 
I_UDP_UPD="{{ iptables_i_udp_upd | default() }}"
## Outbound
# http https
O_TCP_UPD="{{ iptables_o_tcp_upd | default('80 443') }}"
# 
O_UDP_UPD="{{ iptables_o_udp_upd | default() }}"

### Network (server)
## Inbound
# 
I_TCP_SRV="{{ iptables_i_tcp_srv | default() }}"
# 
I_UDP_SRV="{{ iptables_i_udp_srv | default() }}"
## Outbound
# 
O_TCP_SRV="{{ iptables_o_tcp_srv | default() }}"
# 
O_UDP_SRV="{{ iptables_o_udp_srv | default() }}"

### Network (trusted), includes: Trusted, Server, Admin
## Inbound
# 
I_TCP_TRU="{{ iptables_i_tcp_tru | default() }}"
# 
I_UDP_TRU="{{ iptables_i_udp_tru | default() }}"
## Outbound
# dhcp
O_TCP_TRU="{{ iptables_o_tcp_tru | default('67') }}"
# dhcp
O_UDP_TRU="{{ iptables_o_udp_tru | default('67') }}"

### Network (custom), host specific
## Inbound
# ssh
I_TCP="{{ iptables_i_tcp | default() }}"
# 
I_UDP="{{ iptables_i_udp | default() }}"
## Outbound
# ssh
O_TCP="{{ iptables_o_tcp | default() }}"
# 
O_UDP="{{ iptables_o_udp | default() }}"

### Internet (default)
## Inbound
# ssh
I_TCP_INET="{{ iptables_i_tcp_inet | default() }}"
# 
I_UDP_INET="{{ iptables_i_udp_inet | default() }}"
## Outbound
# ssh smtp whois dns rwhois http https git
O_TCP_INET="{{ iptables_o_tcp_inet | default('22 25 43 53 4321 80 443 9418') }}"
# whois dns ntp
O_UDP_INET="{{ iptables_o_udp_inet | default('43 53 123') }}"
