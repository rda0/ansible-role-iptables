# rate limits
# use service name for ports

iptables_lim_on: true
iptables_lim_ports: ssh
iptables_lim_nets: can any
iptables_lim_nets_exclude: ''
iptables_lim_ssh_can_on: true
iptables_lim_ssh_any_on: true
iptables_lim_ssh_can_secs: 60
iptables_lim_ssh_can_hits: 20
iptables_lim_ssh_can_time: 600
iptables_lim_ssh_any_secs: 120
iptables_lim_ssh_any_hits: 5
iptables_lim_ssh_any_time: 3600

# as rate limits
# Enable AS rate limits
iptables_lim_as_on: false
# Enable AS rate limits (UDP)
iptables_lim_as_udp_on: false
# Server to fetch AS subnets (`proto://server:[port]`)
iptables_lim_as_server: http://localhost:53661
# Internal variable: List of all ASNs (limited and blocked)
_iptables_lim_as_list: '{{ iptables_lim_as_block + iptables_lim_as_limit }}'
# List of ASNs to rate-limit
iptables_lim_as_limit: []
# List of ASNs to hard block (REJECT/DROP)
iptables_lim_as_block: []
# List of ports or leave empty to limit all ports
iptables_lim_as_ports: ''
# Maximum average rate[/second|/minute|/hour|/day]
iptables_lim_as_rate: '40/minute'
# Maximum initial number of packets to match
iptables_lim_as_burst: '40'
# Enable per-IP rate limits within AS rate limiting
iptables_lim_as_ip_on: true
# Per-IP rate [/second|/minute|/hour|/day]
iptables_lim_as_ip_rate: '10/minute'
# Per-IP burst
iptables_lim_as_ip_burst: '20'
